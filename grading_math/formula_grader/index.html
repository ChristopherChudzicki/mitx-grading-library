<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>FormulaGrader - MITxGraders</title>

    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">


    <link href="../../css/extra.css" rel="stylesheet">


    <link href="../../css/cinder_tweaks.css" rel="stylesheet">


    <link href="../../css/readthedocs.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="../..">MITxGraders</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../..">Overview</a>
</li>

                        
                            
<li >
    <a href="../../item_grader/">ItemGrader</a>
</li>

                        
                            
<li >
    <a href="../../string_grader/">StringGrader</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Grading Math <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li class="active">
    <a href="./">FormulaGrader</a>
</li>

                        
                            
<li >
    <a href="../numerical_grader/">NumericalGrader</a>
</li>

                        
                            
<li >
    <a href="../matrix_grader/matrix_grader/">MatrixGrader</a>
</li>

                        
                            
<li >
    <a href="../sampling/">Sampling Sets</a>
</li>

                        
                            
<li >
    <a href="../functions/">Function List</a>
</li>

                        
                            
<li >
    <a href="../comparer_functions/">Comparer Functions</a>
</li>

                        
                            
<li >
    <a href="../renderer/">AsciiMath Renderer Definitions</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Grading Lists <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../grading_lists/list_grader/">ListGrader</a>
</li>

                        
                            
<li >
    <a href="../../grading_lists/single_list_grader/">SingleListGrader</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../changelog/">Changelog</a>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../../string_grader/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../numerical_grader/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/mitodl/mitx-grading-library"><i class="fa fa-github"></i> GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#formulagrader">FormulaGrader</a></li>
            <li class="second-level"><a href="#variables-and-sampling">Variables and Sampling</a></li>
                
            <li class="second-level"><a href="#numbered-variables">Numbered Variables</a></li>
                
            <li class="second-level"><a href="#samples-and-failable-evaluations">Samples and Failable Evaluations</a></li>
                
            <li class="second-level"><a href="#functions">Functions</a></li>
                
                <li class="third-level"><a href="#user-functions">User Functions</a></li>
            <li class="second-level"><a href="#constants">Constants</a></li>
                
            <li class="second-level"><a href="#overriding-default-functions-and-constants">Overriding Default Functions and Constants</a></li>
                
            <li class="second-level"><a href="#restricting-student-input">Restricting Student Input</a></li>
                
                <li class="third-level"><a href="#forbidden-strings">Forbidden Strings</a></li>
                <li class="third-level"><a href="#blacklists-and-whitelists">Blacklists and Whitelists</a></li>
                <li class="third-level"><a href="#required-functions">Required Functions</a></li>
            <li class="second-level"><a href="#tolerance">Tolerance</a></li>
                
            <li class="second-level"><a href="#suffixes">Suffixes</a></li>
                
            <li class="second-level"><a href="#sibling-variables">Sibling Variables</a></li>
                
            <li class="second-level"><a href="#comparer-functions">Comparer Functions</a></li>
                
            <li class="second-level"><a href="#other-improvements">Other Improvements</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="formulagrader">FormulaGrader<a class="headerlink" href="#formulagrader" title="Permanent link"> # </a></h1>
<p>FormulaGrader is the grading class used to grade mathematical formulas and closely resembles the behavior of edX's <code>&lt;formularesponse /&gt;</code> tag, but with much more versatility.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>All expressions are treated in a case sensitive manner. This means that variables <code>'m'</code> and <code>'M'</code> are distinct. Case-insensitive FormulaGraders were deprecated in <a href="../../changelog/#version-110">Version 1.1.0</a></li>
<li>All whitespace is stripped from formulas that are entered. So, <code>1 + x ^ 2</code> is equivalent to <code>1+x^2</code>.</li>
</ul>
</div>
<h2 id="variables-and-sampling">Variables and Sampling<a class="headerlink" href="#variables-and-sampling" title="Permanent link"> # </a></h2>
<p>FormulaGrader grades a formula by numerical sampling. That is, random values are  assigned to each of the unknown variables and unknown functions, then the numerical value of the student's input expression and author's answer are calculated. The sampling process is repeated, and if the student answer and author answer compare within the desired tolerance enough times, the student input is graded as correct.</p>
<p>Variables are configured by including a list of strings of each variable name as follows.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;1+x^2+y&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>


<p>Note that the <code>answers</code> parameter follows all of the usual allowances from ItemGrader.</p>
<p>The variables need to have numbers randomly assigned to them. Each is sampled from a <a href="../sampling/">sampling set</a>, which is RealInterval() by default (random numbers from 1 to 5). A variety of different sampling sets are available, including random complex numbers. To specify the sampling set to use for a variable, use the <code>sample_from</code> key.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;1+x^2+y+z/2&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
    <span class="n">sample_from</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">ComplexRectangle</span><span class="p">(),</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
        <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>


<p>The <code>sample_from</code> key must be a dictionary of 'variable_name': sampling_set pairs. You can specify a sampling set, a real interval, or a discrete set of values to sample from. The above example shows each of these in order.</p>
<h2 id="numbered-variables">Numbered Variables<a class="headerlink" href="#numbered-variables" title="Permanent link"> # </a></h2>
<p>You can also specify special variables that are numbered. For example, if you specify that <code>a</code> is a numbered variable, students can include <code>a_{0}</code>, <code>a_{5}</code>, <code>a_{-2}</code>, etc, using any integer. All entries for a numbered variable will use the sampling set specified by the base name.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;a_{0} + a_{1}*x + 1/2*a_{2}*x^2&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">numbered_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span>
    <span class="n">sample_from</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>


<p>If you have a variable name that would clash with a numbered variable (say, you defined <code>a_{0}</code> and also a numbered variable <code>a</code>), then the specific variable has precedence.</p>
<h2 id="samples-and-failable-evaluations">Samples and Failable Evaluations<a class="headerlink" href="#samples-and-failable-evaluations" title="Permanent link"> # </a></h2>
<p>To control the number of samples that are checked to ensure correctness, you can modify the <code>samples</code> key.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;1+x^2&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">samples</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>
</pre></div>


<p>The default for <code>samples</code> is 5.</p>
<p>You may want to allow for a certain number of comparisons to fail before the student is marked incorrect. To do this, set <code>failable_evals</code>. This should be used very sparingly!</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;1+x^2&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">failable_evals</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>


<h2 id="functions">Functions<a class="headerlink" href="#functions" title="Permanent link"> # </a></h2>
<p>By default, a large array of mathematical functions are available for use. See the full list <a href="../functions/">here</a>. Note that functions for manipulating complex variables are available, which allows you to grade complex expressions. In the following example, <code>z*z</code> is recognized to be different from <code>abs(z)^2</code>.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;abs(z)^2&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span>
    <span class="n">sample_from</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">ComplexRectangle</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>


<h3 id="user-functions">User Functions<a class="headerlink" href="#user-functions" title="Permanent link"> # </a></h3>
<p>You can make user-defined functions available for students to use in their answers. To add user-defined functions, pass in a dictionary to the <code>user_functions</code> key as follows.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;x*x&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">user_functions</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>


<p>This defines a function <code>f(x) = x^2</code>. User-defined function names must start with a letter, and can use numbers and underscores, such as <code>my_func2</code>. They are also allowed to have apostrophes (primes) at the end of the name, such as to indicate derivatives. Eg, <code>f''</code>. Be careful about using quotation marks appropriately when using primes in function names!</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s2">&quot;f&#39;&#39;(x)&quot;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">user_functions</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;f&#39;&#39;&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>


<p>You can also specify random functions by specifying a sampling set for a function. You can provide a list of functions to randomly choose from as follows.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s2">&quot;f(x)&quot;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">user_functions</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">]}</span>
<span class="p">)</span>
</pre></div>


<p>Each time this formula is checked, the function <code>f</code> will be sampled from the list of available functions.</p>
<p>You can also specify a random well-behaved function by using the RandomFunction() sampling set.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s2">&quot;f&#39;&#39;(x) + omega^2*f(x)&quot;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;omega&#39;</span><span class="p">],</span>
    <span class="n">user_functions</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="n">RandomFunction</span><span class="p">(),</span>
        <span class="s2">&quot;f&#39;&#39;&quot;</span><span class="p">:</span> <span class="n">RandomFunction</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>


<p>This allows you to grade mathematical expressions that involve unknown functions, such as the differential equation described in this example.</p>
<h2 id="constants">Constants<a class="headerlink" href="#constants" title="Permanent link"> # </a></h2>
<p>By default, four constants are defined: <code>e</code>, <code>pi</code>, and <code>i=j=sqrt(-1)</code>. You can define new constants by passing in a dictionary to <code>user_constants</code> as follows.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;1/sqrt(1-v^2/c^2)&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">],</span>
    <span class="n">user_constants</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">3e8</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>


<p>Constants are like variables that only ever have one value.</p>
<h2 id="overriding-default-functions-and-constants">Overriding Default Functions and Constants<a class="headerlink" href="#overriding-default-functions-and-constants" title="Permanent link"> # </a></h2>
<p>You can override default functions and constants if you really want, although this is discouraged and requires suppressing warnings with <code>suppress_warnings=True</code>. The grader</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;x^2&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">user_functions</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sin&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>


<p>will raise an error</p>
<blockquote>
<p>ConfigError: Warning: 'user_functions' contains entries '['sin']' which will override default values. If you intend to override defaults, you may suppress this warning by adding 'suppress_warnings=True' to the grader configuration.</p>
</blockquote>
<p>The error can be suppressed by setting <code>suppress_warnings=True</code>.</p>
<h2 id="restricting-student-input">Restricting Student Input<a class="headerlink" href="#restricting-student-input" title="Permanent link"> # </a></h2>
<p>For some questions, you will want to restrict the sorts of input that are marked correct. For example, if you want students to expand <code>sin(2*theta)</code>, then you don't want students to be able to just write <code>sin(2*theta)</code> and be graded correct.</p>
<p>FormulaGrader offers a few ways to restrict what sort of answers will be marked correct.</p>
<h3 id="forbidden-strings">Forbidden Strings<a class="headerlink" href="#forbidden-strings" title="Permanent link"> # </a></h3>
<p>You can forbid students from entering certain strings using the <code>forbidden_strings</code> key:</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;2*sin(theta)*cos(theta)&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span>
    <span class="n">forbidden_strings</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*theta&#39;</span><span class="p">,</span> <span class="s1">&#39;theta*&#39;</span><span class="p">,</span> <span class="s1">&#39;theta/&#39;</span><span class="p">,</span> <span class="s1">&#39;+theta&#39;</span><span class="p">,</span> <span class="s1">&#39;theta+&#39;</span><span class="p">,</span> <span class="s1">&#39;-theta&#39;</span><span class="p">,</span> <span class="s1">&#39;theta-&#39;</span><span class="p">],</span>
    <span class="n">forbidden_message</span><span class="o">=</span><span class="s2">&quot;Your answer should only use trigonometric functions acting on theta, not multiples of theta&quot;</span>
<span class="p">)</span>
</pre></div>


<p>If a student tries to use one of these strings, then they receive the <code>forbidden_message</code>, without giving away what the forbidden string is. We recommend using this sparingly, as students will find it confusing. The default <code>forbidden_message</code> is "Invalid Input: This particular answer is forbidden".</p>
<p>Forbidden strings and student answers are stripped of whitespace before being compared. Thus, if <code>x + y</code> is forbidden, then answers containing <code>x+y</code> or <code>x   +   y</code> will be rejected.</p>
<h3 id="blacklists-and-whitelists">Blacklists and Whitelists<a class="headerlink" href="#blacklists-and-whitelists" title="Permanent link"> # </a></h3>
<p>You can disallow specific functions by adding them to the blacklist of functions as a list of disallowed function names. In the following example, <code>sin</code> is disallowed in correct answers.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;sqrt(1 - cos(x)^2)&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">sample_from</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]},</span>
    <span class="n">blacklist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sin&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>


<p>If you want to exclude everything except for a specific set of functions, instead use a whitelist. In the following example, the only allowed functions in correct answers are sin and cos.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;sin(x)/cos(x)&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">whitelist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sin&#39;</span><span class="p">,</span> <span class="s1">&#39;cos&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>


<p>If you want to exclude all functions, use <code>whitelist=[None]</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;pi/2-x&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">whitelist</span><span class="o">=</span><span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="c1"># no functions are allowed</span>
<span class="p">)</span>
</pre></div>


<p>You cannot use a whitelist and a blacklist at the same time.</p>
<h3 id="required-functions">Required Functions<a class="headerlink" href="#required-functions" title="Permanent link"> # </a></h3>
<p>You can specifically require certain functions to appear in the solution. Any solution that does not include all of these functions will generate an error message. To do this, specify a list of strings of function names that are required.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;2*sin(theta)*cos(theta)&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span>
    <span class="n">required_functions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sin&#39;</span><span class="p">,</span> <span class="s1">&#39;cos&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>


<h2 id="tolerance">Tolerance<a class="headerlink" href="#tolerance" title="Permanent link"> # </a></h2>
<p>Student inputs are compared to answers with a numerical tolerance. You can set this as an absolute number (eg, <code>0.1</code>) or a percentage (eg, <code>"0.01%"</code>, which is the default tolerance).  Tolerances must be nonnegative numbers or percentages.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;2*sin(theta)*cos(theta)&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.00001</span>
<span class="p">)</span>
</pre></div>


<p>Tolerances are necessary because of numerical roundoff error that lead to small differences in evaluations of algebraically equivalent expressions. Zero tolerance should be used sparingly, perhaps only with integer sampling and answers.</p>
<h2 id="suffixes">Suffixes<a class="headerlink" href="#suffixes" title="Permanent link"> # </a></h2>
<p>Numbers with a % at the end will be treated as percentages, and converted to the appropriate decimals.</p>
<p>edX also defines a number of metric suffixes (k, M, G, T, m, u, n, and p) that modify a number appropriately. However, in our experience, these metric suffixes lead to more confusion than use. For example, <code>2M</code>, which one would expect should be rejected as an error when <code>2*M</code> was intended, is accepted by edX, interpreted as <code>2*10^6</code>, marked incorrect, and eats a student's attempt. Similarly for all of the other metric suffixes.</p>
<p>We have therefore made the decision to disable metric suffixes by default. If you want to enable them, you can do so using the following.</p>
<div class="codehilite"><pre><span></span><span class="n">grader</span> <span class="o">=</span> <span class="n">FormulaGrader</span><span class="p">(</span>
    <span class="n">answers</span><span class="o">=</span><span class="s1">&#39;2*m&#39;</span><span class="p">,</span>
    <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">],</span>
    <span class="n">metric_suffixes</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>
</pre></div>


<p>We strongly recommend <em>not</em> doing this when using the following variable names: k, M, G, T, m, u, n, and p.</p>
<h2 id="sibling-variables">Sibling Variables<a class="headerlink" href="#sibling-variables" title="Permanent link"> # </a></h2>
<p>When a student submits several mathematical expressions as part of one problem, it is sometimes useful to grade these inputs in comparison to each other. This can be done using <em>sibling variables</em>, which are available when <code>FormulaGrader</code> is used as a subgrader in <strong>ordered</strong> <code>ListGrader</code> problems.</p>
<p>For example:</p>
<div class="codehilite"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mitxgraders</span> <span class="kn">import</span> <span class="n">ListGrader</span><span class="p">,</span> <span class="n">FormulaGrader</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">grader</span> <span class="o">=</span> <span class="n">ListGrader</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">answers</span><span class="o">=</span><span class="p">[</span>
<span class="gp">... </span>        <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;2*x&#39;</span><span class="p">,</span><span class="s1">&#39;3*x&#39;</span><span class="p">),</span>     <span class="c1"># first input can be any of these 3 answers</span>
<span class="gp">... </span>        <span class="s1">&#39;sibling_1^2&#39;</span><span class="p">,</span>          <span class="c1"># second input must be first input squared</span>
<span class="gp">... </span>        <span class="s1">&#39;sibling_2^2&#39;</span>           <span class="c1"># third input must be second input squared</span>
<span class="gp">... </span>    <span class="p">],</span>
<span class="gp">... </span>    <span class="n">ordered</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">subgraders</span><span class="o">=</span><span class="n">FormulaGrader</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>


<p>Note that in this example, the sequence of inputs <code>['2*x', 4*x^2, 16*x^4]</code> is correct, and so is <code>['3*x', 9*x^2, 81*x^4]</code>, but <code>['3*x', 4*x^2, 16*x^4]</code> receives only two-third credit.</p>
<div class="codehilite"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">student_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2*x&#39;</span><span class="p">,</span><span class="s1">&#39;4*x^2&#39;</span><span class="p">,</span> <span class="s1">&#39;16*x^4&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span> <span class="o">=</span> <span class="n">grader</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">student_inputs</span><span class="p">)[</span><span class="s1">&#39;input_list&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span><span class="p">[</span><span class="s1">&#39;ok&#39;</span><span class="p">],</span> <span class="n">result2</span><span class="p">[</span><span class="s1">&#39;ok&#39;</span><span class="p">],</span> <span class="n">result3</span><span class="p">[</span><span class="s1">&#39;ok&#39;</span><span class="p">]</span>
<span class="go">(True, True, True)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">student_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;3*x&#39;</span><span class="p">,</span><span class="s1">&#39;9*x^2&#39;</span><span class="p">,</span> <span class="s1">&#39;81*x^4&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span> <span class="o">=</span> <span class="n">grader</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">student_inputs</span><span class="p">)[</span><span class="s1">&#39;input_list&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span><span class="p">[</span><span class="s1">&#39;ok&#39;</span><span class="p">],</span> <span class="n">result2</span><span class="p">[</span><span class="s1">&#39;ok&#39;</span><span class="p">],</span> <span class="n">result3</span><span class="p">[</span><span class="s1">&#39;ok&#39;</span><span class="p">]</span>
<span class="go">(True, True, True)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">student_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;3*x&#39;</span><span class="p">,</span><span class="s1">&#39;4*x^2&#39;</span><span class="p">,</span> <span class="s1">&#39;16*x^4&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span> <span class="o">=</span> <span class="n">grader</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">student_inputs</span><span class="p">)[</span><span class="s1">&#39;input_list&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span><span class="p">[</span><span class="s1">&#39;ok&#39;</span><span class="p">],</span> <span class="n">result2</span><span class="p">[</span><span class="s1">&#39;ok&#39;</span><span class="p">],</span> <span class="n">result3</span><span class="p">[</span><span class="s1">&#39;ok&#39;</span><span class="p">]</span>
<span class="go">(True, False, True)</span>
</pre></div>


<p>Other things:</p>
<ul>
<li>Sibling variables are available to <code>FormulaGrader</code>, <code>NumericalGrader</code>, and <code>MatrixGrader</code>, but only in <strong>ordered</strong> <code>ListGrader</code> problems.</li>
<li>The jth student input is referenced as <code>sibling_j</code>. (Exception: If nesting <code>ListGraders</code> with grouping, <code>sibling_j</code> refers to the jth member of any particular group.)</li>
</ul>
<h2 id="comparer-functions">Comparer Functions<a class="headerlink" href="#comparer-functions" title="Permanent link"> # </a></h2>
<p>Comparer functions allow you to compare the student input to the author's expectation using aspects other than equality. See <a href="../comparer_functions/">Comparer Functions</a> for details.</p>
<h2 id="other-improvements">Other Improvements<a class="headerlink" href="#other-improvements" title="Permanent link"> # </a></h2>
<p>We have made a number of other improvements over the edX formula graders, including:</p>
<ul>
<li>Square roots and other functions have a wider domain: with edX's default FormulaResponse, authors need to be careful that expressions like <code>sqrt(x-1)</code> or <code>(x-1)^0.5</code> always pass nonnegative inputs to the square root and power functions. Our square root, power, logarithm, and inverse trigonometric functions accept a wider array of inputs (the entire complex plane, minus poles). For this reason, authors can feel safe using the default sample range in most cases.</li>
<li>Our parser uses a parsing cache, and hence runs much more efficiently than the edX graders.</li>
<li>If a student inputs an expression with mismatched parentheses, this generates an intelligible error message that points to the exact issue.</li>
<li>When students use an unknown variable, the resulting error message highlights that the unknown quantity was interpreted as a variable.</li>
<li>Similarly, when students use an unknown function, the resulting error message highlights that the unknown quantity was interpreted as a function. If a variable of that name exists, the error message suggests that a multiplication symbol was missing.</li>
<li>If an unexpected error occurs, students will see a generic "invalid input" message. To see exactly where things went wrong, set the <code>debug</code> flag to <code>True</code>, and a more technical message will usually be displayed.</li>
<li>Full sampling details are included when the <code>debug</code> flag is set to <code>True</code>.</li>
<li>Enhancements to the AsciiMath renderer (the preview that students see when using <code>&lt;textline /&gt;</code> inputs) are available using our <a href="../renderer/">AsciiMath renderer definitions</a>.</li>
</ul></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../../js/jquery-1.10.2.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../..';
    </script>
    <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
    <script src="../../js/base.js"></script>
    <script src="../../search/require.js"></script>
    <script src="../../search/search.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
